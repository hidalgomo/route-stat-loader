(()=>{"use strict";class e{executables=[];constructor(t){if(this.constructor===e)throw new Error("Abstract class cannot be instantiated.");Object.defineProperty(this,"element",{value:t,writable:!1})}}class t extends e{constructor(e){if(super(e),this.constructor===t)throw new Error("Abstract class cannot be instantiated.")}_show(){this.element.classList.remove("display-none")}_hide(){this.element.classList.add("display-none")}}const s=new class extends t{constructor(){super(document.querySelector(".modal-bg")),this.element&&this.element.addEventListener("click",(()=>this.hide()))}init(e){this.executables=[...e]}show(){this._show()}hide(){this._hide(),this.executables.map((e=>e()))}};class r extends e{constructor(e){if(super(e),this.constructor===r)throw new Error("Abstract class cannot be instantiated.")}_show(e){this.element.style.width=e}_hide(){this.element.style.width=0}}const o=new class extends r{constructor(){super(document.querySelector(".route-detail-container"))}show(){this._show("70%")}hide(){this._hide()}};o.selectedRoute=new class extends e{constructor(){super(document.querySelector(".selected-route-label"))}},o.closeBtn=new class extends e{constructor(){super(document.getElementById("closeRouteDetailBtn")),this.element&&this.element.addEventListener("click",(()=>this.executables.map((e=>e()))))}init(e){this.executables=[...e]}};const n={MB:{name:"Manhattan-Bronx",orderNum:1},BQ:{name:"Brooklyn-Queens",orderNum:2},SI:{name:"Staten Island",orderNum:3}},a={BQ_99_RH_H101:"Belt Parkway",MB_99_RH_H101:"Bronx River Parkway",BQ_99_RH_H102:"Brooklyn Queens Expressway",MB_99_RH_H102:"Bruckner Expressway",BQ_99_RH_H103:"Clearview Expressway",MB_99_RH_H103:"Cross Bronx Expressway",BQ_99_RH_H104:"Cross Island Parkway",SI_99_RH_H101:"Dr M L King Jr Expressway",MB_99_RH_H104:"Franklin D Roosevelt Drive",BQ_99_RH_H105:"Gowanus Expressway",BQ_99_RH_H106:"Grand Central Parkway",MB_99_RH_H105:"Harlem River Drive",MB_99_RH_H106:"Henry Hudson Parkway",MB_99_RH_H107:"Hutchinson River Parkway",BQ_99_RH_H107:"Jackie Robinson Parkway",SI_99_RH_H102:"Korean War Vets Parkway",BQ_99_RH_H108:"Long Island Expressway",MB_99_RH_H108:"Major Deegan Expressway",MB_99_RH_H109:"Mosholu Parkway",BQ_99_RH_H109:"Nassau Expressway",MB_99_RH_H110:"Pelham Parkway",BQ_99_RH_H110:"Prospect Expressway",MB_99_RH_H111:"Sheridan Boulevard",SI_99_RH_H103:"Staten Island Expressway",BQ_99_RH_H111:"Van Wyck Expressway",SI_99_RH_H104:"West Shore Expressway"},i=new class{constructor(e){Object.assign(this,e)}create(e,t){return new this[e](t)}}({Route:function(e){Object.assign(this,e),this.fullName=a[this.route_name],this.template=(e="fullName",t="pctcomp_combined")=>`\n            <div class="route" id="${this.route_name}" title="${this[e]}">\n                <div class="route-label">${this[e]}</div>\n                <div class="outer-progress-bar">\n                    <div class="inner-progress-bar ${(e=>{const t=Math.abs(100*e);return t<50?"red-bg":t>=50&&t<70?"yellow-bg":t>=70&&t<80?"light-green-bg":t>=80&&t<90?"mid-green-bg":"dark-green-bg"})(this[t])}"></div>\n                    <div class="progress-percent">${(100*this[t]).toFixed(1)}%</div>\n                </div>\n            </div>`},Borough:function(e){this.shortName=e,this.fullName=n[e]&&n[e].name,this.routes=[],this.template=()=>{let e="";for(let t of this.routes)e+=t.template();return`\n            <div class="borough">\n                <div class="borough-label">\n                    <div>${this.fullName&&this.fullName.toLowerCase()}</div>\n                </div>\n                <div class="route-container">${e}</div>\n            </div>`}}}),u=new class{#e;#t=[];#s=[];#r(e){return[...new Set(e.map((e=>e.borough)))]}#o(e){return e.map((e=>this.#e.create("Borough",e)))}#n(e){return e.map((e=>this.#e.create("Route",e)))}constructor(e){this.#e=e}load(e){this.#t=this.#o(this.#r(e.routes)),this.#s=this.#n(e.routes)}sortByOrderNum(){this.#t=this.#t.sort(((e,t)=>n[e.shortName]&&n[t.shortName]&&n[e.shortName].orderNum<n[t.shortName].orderNum?-1:1))}getBoroughsWithUniqueRoutes(){const e=[],t=new Set;for(let s of this.#s)t.has(s.route_name)||(e.push(s),t.add(s.route_name));for(let t of this.#t)t.routes=e.filter((e=>t.shortName===e.borough));return this.#t}getRoutesByName(e){return this.#s.filter((t=>t.route_name===e))}}(i),c=new class{#a;#i;constructor(){}init(e,t){return this.#a=document.querySelector(e),this.#i=t,this}async render(e){return this.#a.innerHTML="",await new Promise(((t,s)=>{for(let t of this.#i)this.#a.innerHTML+=e(t);setTimeout((()=>t()),100)}))}afterRender(e){let t,s;for(let r of this.#a.getElementsByClassName("route"))e&&r&&r.addEventListener("click",(function(){e(this)})),s=r.querySelector(".progress-percent").innerHTML,t=r.querySelector(".inner-progress-bar"),t.style.width=s}},l=new class{constructor(){}getParameters(){return`?${window.location.hash.substring(1)}`}async getAsync(e){return await fetch(e).then((e=>e.json()))}},h=new class{constructor(){}run(e){window.onload=()=>{e()}}};s.init([()=>o.hide()]),o.closeBtn.init([()=>s.hide(),()=>o.hide()]),h.run((()=>{const e="./json_dataset.json"+l.getParameters();l.getAsync(e).then((e=>{u.load(e),u.sortByOrderNum();const t=u.getBoroughsWithUniqueRoutes();c.init(".borough-container",t).render((e=>e.template())).then((()=>{c.afterRender((e=>{const t=u.getRoutesByName(e.id);c.init(".route-detail",t).render((e=>e.template("equipment_id","pctcomp_specific"))).then((()=>{c.afterRender(),o.selectedRoute.element.textContent=t[0].fullName,o.show(),s.show()}))}))}))}))}))})();